setting: supervised

train_dataset:
  dataset_name: camera_real
  dataset_dir: /media/wby/mdata/10位姿估计/数据集/data
  num_mini_batch_per_epoch: 4000
  image_size: 224       # [192, 224]
  sample_num: 1024
  outlier_th: 0.1
  syn_bs: 15
  real_bs: 5
  syn_num_workers: 12
  real_num_workers: 4
  shuffle: True
  drop_last: True
  pin_memory: True

test_dataset:
  img_size: 224         # [192, 224]
  sample_num: 1024
  dataset_dir: /media/wby/mdata/10位姿估计/数据集/data
  dataset_name: camera

pose_net:
  rgb_backbone: resnet    # [resnet, dino]
  cat_num: 6

  IAKD:
    kpt_num: 96
    query_dim: 256

    # --- 新增但必要的参数 ---
    rgb_dim: 128        # ← 原 rgb_local 的通道数 (你原代码里是 128)
    pts_dim: 128        # ← 原 pts_local 的通道数 (你原代码里是 128)
    backbone_dim: 128   # ← 统一投影维度，可与 rgb_dim 相同

    heatmap_mode: attn  # 可选：attn / cosine / both

    # --- Transformer 输入 ---
    d_model: 256        # ← query_dim 必须 = d_model，否则要加 projection（已自动处理）

    # --- Attention Layer ---
    AttnLayer:
      block_num: 4
      d_model: 256
      dim_ffn: 512       # 建议比原来的 256 大一些，提高表达力
      num_head: 4
      dropout: 0.0
      use_rope: False    # 若 pts_local 有 xyz，可以设置 True
      layerscale_init: 0.00001

  GAFA:
    block_num: 2
    K: [ 16, 32 ]
    d_model: 256
  NOCS_Predictor:
    cat_num: 6
    bins_num: 64
    AttnLayer:
      block_num: 2
      d_model: 256
      dim_ffn: 256
      num_head: 4
  Reconstructor:
    pts_per_kpt: 10
    ndim: 256
  
optimizer:
  name: Adam
  lr: 0.01
  weight_decay: 0

lr_scheduler:
  name: CyclicLR
  mode: triangular
  base_lr: 0.00002
  max_lr: 0.0005
  step_size_up: 20000
  step_size_down: 20000
  cycle_momentum: False

max_epoch : 30

loss:
  cd: 2.0
  nocs: 2.0
  recon: 15.0
  delta: 1.0
  diversity: 10.0
  pose: 0.3
  th: 0.01
  obj_aware: True

rd_seed: 1

per_val: 10  # do the evaluation per per_val epochs 
per_write: 50  # write down the info per per_write iterations